var mdfajs=mdfajs||{REVISION:"ALPHA"};(function(c){const g=Math.PI;const f=Math.SQRT1_2;var e=function(h){if(h instanceof e){this.real=new Array(h.real);this.imag=new Array(h.imag)}else{this.real=new Array(h);this.imag=new Array(this.real.length)}this.length=this.real.length};e.prototype={FFT:function(){return e.fft(this,false)},InvFFT:function(){return e.fft(this,true)}};e.fft=function(i,h){const j=i.length;if(j&(j-1)){return e.FFT_Recursive(i,h)}else{return e.FFT_2_Iterative(i,h)}};e.FFT_Recursive=function(A,t){const o=A.length;if(o===1){return A}const q=new e(o);const h=a(o);const r=o/h;const w=1/Math.sqrt(h);var z=new e(r,A.ArrayType);for(var s=0;s<h;s++){for(var u=0;u<r;u++){z.real[u]=A.real[u*h+s];z.imag[u]=A.imag[u*h+s]}if(r>1){z=e.fft(z,t)}const l=Math.cos(2*g*s/o);const y=(t?-1:1)*Math.sin(2*g*s/o);var k=1;var x=0;for(var u=0;u<o;u++){const v=z.real[u%r];const B=z.imag[u%r];q.real[u]+=k*v-x*B;q.imag[u]+=k*B+x*v;k=k*l-x*y;x=k*y+x*l}}for(var u=0;u<o;u++){A.real[u]=w*q.real[u];A.imag[u]=w*q.imag[u]}return A};e.FFT_2_Iterative=function(r,m){const u=r.length;const q=d(r);const x=q.real;const B=q.imag;var v=1;while(v<u){const t=Math.cos(g/v);const w=(m?-1:1)*Math.sin(g/v);for(var z=0;z<u/(2*v);z++){var p=1;var s=0;for(var y=0;y<v;y++){const C=2*z*v+y;const k=C+v;const A=x[C];const h=B[C];const l=p*x[k]-s*B[k];const o=s*x[k]+p*B[k];x[C]=f*(A+l);B[C]=f*(h+o);x[k]=f*(A-l);B[k]=f*(h-o);p=p*t-s*w;s=p*w+s*t}}v<<=1}return q};function b(h,j){var i=0;while(j>1){i<<=1;i+=h&1;h>>=1;j>>=1}return i}function d(p){const o=p.length;const m=new Set();for(var l=0;l<o;l++){const h=b(l,o);if(m.has(l)){continue}var k=p.real[l];p.real[l]=p.real[h];p.real[h]=k;var j=p.imag[l];p.imag[l]=p.imag[h];p.imag[h]=j;m.add(h)}return p}function a(j){const h=Math.sqrt(j);var i=3;while(i<=h){if(j%i===0){return i}i+=2}return j}c.ComplexArray=e})(mdfajs);(function(b){var a=function(k){var l=k.length;var e=0;var h=0;var d=l/2;this.real=new Array(d+1);this.imag=new Array(d+1);for(var f=0;f<=d;f++){e=0;h=0;for(var g=0;g<l;g++){var c=((g+1)*Math.PI*f/d);e+=Math.cos(c)*k[g];h+=Math.sin(c)*k[g]}this.real[f]=e;this.imag[f]=h}};b.Periodogram=a})(mdfajs);(function(b){var a=function(j,d,f,e,i,h,g,k,c){this.L=j;this.cutoff=d;this.i1=f;this.lag=e;this.lambda=i;this.expweight=h;this.decay=g;this.decay2=k;this.smooth=c;this.reg_mat=new b.Regularization(j,e,f,g,k,c)};a.changeRegularization=function(c,h,g,f,e,d){this.L=c;this.i1=g;this.lag=h;this.decay=f;this.decay2=e;this.smooth=d;this.reg_mat=new b.Regularization(c,h,g,f,e,d)};b.Parameters=a})(mdfajs);(function(b){var a=function(p,n,c,k,f,e,g){var q=n/2;var m=new b.Weights(n,c,f);this.gamma=m.gamma;this.rex=numeric.rep([q+1,p],0);this.imx=numeric.rep([q+1,p],0);this.rows=q+1;this.cols=p;for(var d=0;d<p;d++){for(var h=0;h<=q;h++){var s=((d-e)*Math.PI*h/q);var i=new Complex(g.real[h]*m.expweight[h],g.imag[h]*m.expweight[h]);var o=new Complex(0,s).exp();var r=(o).mul(i);this.rex[h][d]=r.re;this.imx[h][d]=Math.sqrt(1+m.gamma[h]*k)*r.im}}};b.Gramm=a})(mdfajs);(function(b){var a=function(h,d,f){const c=h/2;this.cutoff=d;this.N=h;this.gamma=new Array(c+1);this.expweight=new Array(c+1);for(var e=0;e<this.gamma.length;e++){var g=e*Math.PI/c;this.gamma[e]=(g<d)?1:0;this.expweight[e]=(g<d)?1:Math.pow(g+1,f/10)}};b.Weights=a})(mdfajs);(function(e){var f=e.ComplexArray;var b=function(){};b.solve=function c(I,h){var B=I.rex.slice(0);var x=I.imx.slice(0);var v=h.des_mat.slice(0);var u=h.Q_smooth.slice(0);var o=numeric.transpose(v);var F=numeric.dot(B,o);var g=numeric.dot(x,o);var q=numeric.dot(numeric.transpose(F),F);var s=numeric.dot(numeric.transpose(g),g);q=numeric.add(q,s);var m=numeric.sum(numeric.getDiag(q))/h.w_eight.length;var n=numeric.dot(u,o);var y=numeric.dot(v,n);var t=numeric.dot(u,h.w_eight);var G=numeric.dot(v,t);if(h.smooth>0){var w=numeric.sum(numeric.getDiag(u));var k=numeric.sum(numeric.getDiag(y));w=w/k;for(var A=0;A<h.ncols2;A++){for(var z=0;z<h.ncols2;z++){y[A][z]*=y[A][z]*w*m}}for(var A=0;A<h.ncols;A++){for(var z=0;z<h.ncols;z++){u[A][z]*=u[A][z]*w}}}var E=numeric.dot(B,h.w_eight);var H=numeric.dot(numeric.transpose(F),E);var D=numeric.dot(x,h.w_eight);var r=numeric.dot(numeric.transpose(g),D);r=numeric.add(r,H);var C=numeric.dot(numeric.transpose(B),I.gamma);C=numeric.sub(C,r);for(var A=0;A<G.length;A++){G[A]*=G[A]*m}C=numeric.sub(C,G);q=numeric.add(q,y);var p=numeric.LU(q);var l=numeric.LUsolve(p,C);return numeric.dot(o,l)};b.applyFilter=function a(q,g){if(q instanceof f){var r=q.real.slice(0)}else{var r=q.slice(0)}const n=g.length;const o=r.length;var p=numeric.rep([o-(n-1)],0);var h=numeric.rep([o-(n-1)],0);var m=0;for(var k=n-1;k<o;k++){m=0;for(var j=0;j<n;j++){m=m+g[j]*r[k-j]}p[k-(n-1)]=m;h[k-(n-1)]=r[k]}return{st:p,xt:h}};b.computeFilter=function d(g){};e.Mdfa=b})(mdfajs);(function(a){var b=function(r,e,g,o,t,c){this.ncols=r;this.ncols2=(g===1)?r-1:r;var d=this.ncols;var n=this.ncols2;const p=Math.floor(e);var m=numeric.rep([d,d],0);this.des_mat=numeric.rep([n,d],0);this.Q_smooth=numeric.rep([d,d],0);this.w_eight=numeric.rep([d],0);o=Math.tan(Math.min(o,0.999999)*Math.PI/2);t=100*Math.tan(Math.min(t,0.999999)*Math.PI/2);c=100*Math.tan(Math.min(c,0.999999)*Math.PI/2);this.Q_smooth[0][0]=c;this.Q_smooth[0][1]=-2*c;this.Q_smooth[0][2]=c;m[0][0]=t*Math.pow(1+o,2*Math.abs(-e));this.Q_smooth[1][0]=-2*c;this.Q_smooth[1][1]=5*c;this.Q_smooth[1][2]=-4*c;this.Q_smooth[1][3]=c;m[1][1]=t*Math.pow(1+o,2*Math.abs(1-e));var f=r-1;this.Q_smooth[f][f-2]=c;this.Q_smooth[f][f-1]=-2*c;this.Q_smooth[f][f]=1*c;m[f][f]=t*Math.pow(1+o,2*Math.abs(1*f-e));f=r-2;this.Q_smooth[f][f-2]=c;this.Q_smooth[f][f-1]=-4*c;this.Q_smooth[f][f]=5*c;this.Q_smooth[f][f+1]=-2*c;m[f][f]=t*Math.pow(1+o,2*Math.abs(1*f-e));for(var l=2;l<r-2;l++){m[l][l]=t*Math.pow(1+o,2*Math.abs(1*l-e));this.Q_smooth[l][l-2]=c;this.Q_smooth[l][l-1]=-4*c;this.Q_smooth[l][l]=6*c;this.Q_smooth[l][l+1]=-4*c;this.Q_smooth[l][l+2]=c}var k=1e-15;var q=1e-15;for(var l=0;l<r;l++){k=k+m[l][l];q=q+this.Q_smooth[l][l]}if(t>0||c>0){for(var l=0;l<r;l++){for(var h=0;h<r;h++){m[l][h]*=m[l][h]*t/k;this.Q_smooth[l][h]*=this.Q_smooth[l][h]*c/q;this.Q_smooth[l][h]+=m[l][h]}}}if(g===0){for(var l=0;l<r;l++){this.des_mat[l][l]=1}if(e<1){this.w_eight[0]=1}else{this.w_eight[p]=1}}else{var s=0;for(var l=0;l<r-1;l++){if(e<1){this.des_mat[l][l+1]=1;this.des_mat[l][0]=-1}else{s=(l>=e)?l+1:l;this.des_mat[l][s]=1;this.des_mat[l][p]=-1}}}};a.Regularization=b})(mdfajs);(function(a){if(typeof module==="undefined"||typeof module.exports==="undefined"){window.mdfajs=a}else{module.exports=a}})(mdfajs);